---
title: "Environmental Injustice in the Inland Empire, CA"
author: "Kylie Newcomer"
date: 10/06/2025
format: pdf
execute: 
  warning: false
  error: false
  message: false
---

```{r, echo=FALSE}
library(tidyverse)
library(sf)
library(here)
library(stars)
library(tmap)
```

### Reading in the Data
```{r}
# read in geodatabase of EJScreen data at the Census Block Group level
ejscreen <- sf::st_read(here::here("data", "ejscreen","EJSCREEN_2023_BG_StatePct_with_AS_CNMI_GU_VI.gdb")) 

# filter to a state I am interested in
california <- ejscreen %>%
  dplyr::filter(ST_ABBREV == "CA") 

# filter to a county you are interested in
ie <- ejscreen %>% # selecting counties in the Inland Empire
  dplyr::filter(CNTY_NAME %in% c("Riverside County", "San Bernardino County"))



# find the average values for all variables within counties
california_counties <- aggregate(california, 
                                 by = list(california$CNTY_NAME), 
                                 FUN = mean)
```


### Initial Data Exploration

```{r}
# creating an initial map to visualize parameter of interest
tm_shape(ie) +
  tm_polygons(fill = "LOWINCPCT", 
              fill.legend = tm_legend(title = "Percent of Low \nIncome Households", 
                                      orientation = "portrait", 
                                      tm_pos_out = c("center", "right"),
                                      frame = FALSE),
              fill.scale = tm_scale_continuous(values = "-magma", 
                                               labels = c("0%", "20%", "40%", 
                                                          "60%", "80%", "100%"))) +
  tm_scalebar(position = tm_pos_in("right", "top")) +
  tm_compass(position = c("left", "top")) +
  tm_title("Distribution of Low Income Households in the Inland Empire")

```

```{r}
# Creating another map to visualize my other parameter of interest
tm_shape(ie) +
  tm_polygons(fill = "PRE1960PCT", 
              fill.legend = tm_legend(title = "Percent of Homes \nwith Lead Paint", 
                                      tm_pos_out = c("center", "bottom"),
                                      orientation = "portrait",
                                      frame = FALSE), 
              fill.scale = tm_scale_continuous(values = "-magma", 
                                               labels = c("0%", "20%", "40%", 
                                                          "60%", "80%", "100%"))) +
  tm_scalebar(position = tm_pos_in("right", "top")) +
  tm_compass(position = c("left", "top")) +
  tm_title("Distribution of Homes with Lead Paint in the Inland Empire")
  
```

### Creating my variables of interest
To determine how children in low income areas are at potential risk to lead paint exposure, the number of children in low income homes is first estimated by multiplying the number of children under 5 years old by the percent of low income households.
```{r}
# Looking at children in poverty
ie_kids <- ie %>% 
  select(UNDER5, LOWINCPCT) %>%
  mutate(kid_inc = (UNDER5*LOWINCPCT)) # Number of children multiplied by percent in poverty

# Checking the min and max to see the range
min(ie_kids$kid_inc)
max(ie_kids$kid_inc)
```

A second variable to estimate number of children in houses built before 1960 (lead paint exposure) is created the same way as the previous variable.
```{r}
# Want to see how that compares to children living in homes with lead pain
ie_lead <- ie %>% 
  select(UNDER5, PRE1960PCT) %>% 
  mutate(kid_lead = (UNDER5*PRE1960PCT)) # Number of children multiplied by percent of homes built pre 1960

# Checking the min and max to see the range
min(ie_lead$kid_lead)
max(ie_lead$kid_lead)
```

## Environmental Injustice Maps
The two variables estimating number of children in low income households and homes built before 1960 are separately plotted to look for a correlation between children in low income homes and children with exposure to lead paint.
```{r}
tm_shape(ie_kids) +
  tm_polygons(fill = "kid_inc", 
              fill.legend = 
                tm_legend(title = "Estimated Number of Children", 
                                      tm_pos_out = c("center", "bottom"),
                                      orientation = "portrait",
                                      frame = FALSE), 
              fill.scale = tm_scale_intervals(values = "-magma", 
                                              n = 8)) +
  tm_scalebar(position = tm_pos_in("right", "top")) +
  tm_compass(position = c("left", "top")) +
  tm_title("Children Living in Poverty in the Inland Empire")
```

```{r}
tm_shape(ie_lead) +
  tm_polygons(fill = "kid_lead", 
              fill.legend = 
                tm_legend(title = "Estimated Number of Children", 
                                      tm_pos_out = c("center", "bottom"),
                                      orientation = "portrait",
                                      frame = FALSE), 
              fill.scale = tm_scale_intervals(values = "-magma")) +
  tm_scalebar(position = tm_pos_in("right", "top")) +
  tm_compass(position = c("left", "top")) +
  tm_title("Children Living in Homes with Lead Paint in the Inland Empire")
```

The data contains population demographic and environmental factors throughout the US. I focused on the Inland Empire (Riverside and San Bernardino county) of California, because of the fast growing communities and relatively "affordable" living compared to other counties in Southern California. I started by mapping my factors of interest (poverty levels and potential homes with lead paint). I wanted to specifically focus on quality of life for children under 5 years old, starting with estimating how many children are living in poverty. After seeing regions with a large amount children living in poverty, I compared that to how many children were living in homes with lead paint. There did not seem to be a correlation between regions with high poverty levels and high percentages of homes with lead paint. I attempted other visualizations to see if there were increased health or environmental threats to the children in areas with high poverty levels but was unable to come to any conclusions.

